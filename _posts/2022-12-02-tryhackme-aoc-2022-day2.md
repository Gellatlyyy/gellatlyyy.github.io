---
date: 2022-12-02T01:00:00.000Z
layout: post
title: Advent of Cyber - Day 2
subtitle: TryHackMe Advent of Cyber 2022 - Day 2.
description: A writeup of Day 2 - TryHackMe Advent of Cyber 2022 Challenge.
image: >-
  https://tryhackme.com/img/events/christmas/aoc4-wallpaper-2.png
optimized_image: >-
  https://tryhackme.com/img/events/christmas/aoc4-wallpaper-2.png
category: challenge
tags:
  - AOC2022
  - TryHackMe
  
author: Cameron Gellatly
paginate: true
---

Day 2 is all about Log analysis.

Log analysis is an essential skill as it can help the response team figure out:
1.	How an attacker gained access
2.	Who is the attacker (IP address)
3.	What has an attacker gained access to
4.	Has the integrity of the systems been compromised in any way
5.	Has data been exfiltrated.

In this exercise, we will primarily be using grep to analyze log files and find information about the attack.

# Question 1:
**Use the ls command to list the files present in the current directory. How many log files are present?**

Running ls on the current directory displays two log files – SSHD.log and webserver.log
![img1](https://drive.google.com/uc?id=19dkiVrN34ZKCBXOWwEYHYsAN0uLwOm9V)

# Question 2:
**Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?**

We can make an educated guess that the log file is webserver.log
![img2](https://drive.google.com/uc?id=1O5OR9sP0uKYctIy8Et2aK4av5QHpt51V)

# Question 3:
**On what day was Santa's naughty and nice list stolen?**

To find this information, we can use grep on the webserver.log file. I ran a basic query to search for any activity relating to “Christmas” as this is a likely attack vector. 
< grep “christmas” webserver.log >
This returned multiple results, all within a very short timeframe of each other and all from the same IP address. I tested to see if this was the correct answer.
![img3](https://drive.google.com/uc?id=1X0K0WK2oRkF_e_VIwgdpNbIFudbGtzo6)

![img4](https://drive.google.com/uc?id=1-oT9j5oyynS_sZH3ec3Cx8ueWP_jmn87)
# Question 4:
**What is the IP address of the attacker?**

Based on the information gathered in the previous task, I can see that the attacking IP is:
10.10.249.191
![img5](https://drive.google.com/uc?id=1NhCPovYJAV4LI7uUQRi7h1LHwfVPjuq4)

# Question 5:
**What is the name of the important list that the attacker stole from Santa?**

The word List stands out to me here and I immediately want to narrow down my search results to anything containing file extensions such as csv and .txt. I created a more advanced search query after consulting the grep help page.
< grep “\.csv” webserver.log > – No matches 
< grep “\.txt” webserver.log > – Hit! 
 
I tested santalist.txt into the answer box and found:
![img6](https://drive.google.com/uc?id=1csEWgzp9vOpF8arsO2QHE4f5oHBToquU)

# Question 6:
**Look through the log files for the flag. The format of the flag is: THM{}**

On to the last task, locate the flag. Once again I turned to grep for this task. A basic search query should find this.
< grep “THM{“ webserver.log > – No matches. 
I then ran the same query but now on the second log file, SSHD.log
< grep “THM{“ webserver.log > - Flag located.
![img7](https://drive.google.com/uc?id=1EOoRqRj-1FkB6w0yk5JEqtnGA42c4sqg)

 

All tasks are now completed for Day 2.
